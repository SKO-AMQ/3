<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Alqhtani Quiz</title>
  <style>
    :root {
      --bg: #0e0e0e;
      --text: #fff;
      --muted: #bcbcbc;
      --accent: #1d4ed8;
      --border: #1e2937;
      --correct: #22c55e;
      --wrong: #ef4444;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, sans-serif;
      display: flex;
      justify-content: center;
      min-height: 100vh;
    }
    .shell {
      width: min(1100px, 100%);
      padding: 2rem 1.5rem 4rem;
    }

    .progress-line { width: 100%; height: 4px; background: rgba(255,255,255,.04); border-radius: 999px; overflow: hidden; margin-bottom: 1rem; }
    .progress-line span { height: 100%; background: #22c55e; display: block; width: 0%; transition: width .25s; }

    .breadcrumb { text-align: center; font-size: .8rem; color: #d4d4d4; margin-bottom: 1.2rem; }
    .breadcrumb span { cursor: pointer; }
    .breadcrumb .active { color: #fff; font-weight: 600; }

    .logo-name {
      font-size: 2.4rem;
      font-weight: 700;
      color: #ff4d4d;
      margin-bottom: 0.3rem;
      text-align: left;
    }
    .logo-sub {
      color: #f0f0f0;
      font-size: .9rem;
      margin-bottom: 1.2rem;
    }

    .select-title { font-size: 1.2rem; margin-bottom: 1rem; }
    .option-btn, .subject-btn {
      width: 100%;
      background: #0f172a;
      border: 1px solid rgba(255,255,255,.04);
      color: #fff;
      padding: .75rem .9rem;
      border-radius: .6rem;
      font-size: 1.05rem;
      text-align: left;
      cursor: pointer;
      margin-bottom: .75rem;
      transition: .15s;
    }
    .option-btn:hover, .subject-btn:hover { border-color: var(--accent); transform: translateY(-1px); }

    #subject-screen, #quiz-screen { display: none; }

    .quiz-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.4rem;
    }
    .brand {
      font-size: 2.3rem;
      font-weight: 700;
      color: #ff4d4d;
      line-height: 1.1;
    }
    .brand-sub {
      color: #f0f0f0;
      font-size: .75rem;
      margin-top: .25rem;
    }
    .center-title { text-align: center; flex: 1; }
    .quiz-title { font-size: 2rem; font-weight: 600; }
    .info-chips {
      margin-top: .4rem;
      display: flex;
      gap: .5rem;
      justify-content: center;
    }
    .chip {
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.03);
      padding: .2rem .5rem;
      border-radius: 999px;
      font-size: .65rem;
      color: var(--muted);
    }
    /* ÿßŸÑÿ≥ÿ∑ÿ±ŸäŸÜ ÿ™ÿ≠ÿ™ ÿßŸÑÿØŸàÿßÿ¶ÿ± */
    .fixed-names {
      margin-top: 1rem;
      text-align: left;
      font-size: .8rem;
      line-height: 1.15;
    }
    .tools {
      display: flex;
      gap: .5rem;
      align-items: center;
      justify-content: center;
    }
    .icon-btn {
      width: 38px;
      height: 38px;
      background: #0f172a;
      border: 1px solid #1e293b;
      border-radius: .5rem;
      display: grid;
      place-items: center;
      cursor: pointer;
      font-size: .9rem;
    }
    .icon-btn.active { background: var(--accent); }

    .badge-pill {
      display: inline-block;
      background: #1d4ed8;
      padding: .35rem 1rem;
      border-radius: .3rem;
      font-size: .75rem;
      margin-bottom: 1rem;
    }
    .q-wrap { max-width: 820px; }
    .q-text {
      font-size: 1.35rem;
      margin-bottom: 1rem;
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      align-items: center;
    }
    .result {
      font-size: .75rem;
      font-weight: 600;
    }
    .result.correct { color: var(--correct); }
    .result.wrong { color: var(--wrong); }

    .choices {
      display: flex;
      flex-direction: column;
      gap: .75rem;
    }
    .choice-btn {
      background: transparent;
      border: none;
      border-bottom: 1px solid rgba(255,255,255,.04);
      padding: .45rem 0;
      display: flex;
      gap: .75rem;
      align-items: center;
      color: #fff;
      font-size: .95rem;
      cursor: pointer;
    }
    .choice-btn:hover { background: rgba(255,255,255,.015); }
    .choice-btn.correct { color: var(--correct); border-color: var(--correct); }
    .choice-btn.wrong { color: var(--wrong); border-color: var(--wrong); }

    .nav-area {
      margin-top: 2.6rem;
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      align-items: center;
    }
    .nav-btns {
      display: flex;
      gap: 3rem;
    }
    .nav-btn {
      background: #0f172a;
      border: 1px solid #1e293b;
      color: #fff;
      cursor: pointer;
      padding: .65rem 3.4rem;
      border-radius: .6rem;
      font-size: .95rem;
      font-weight: 500;
    }
    .nav-btn:disabled { opacity: .35; cursor: not-allowed; }

    .jump-menu {
      display: flex;
      gap: .5rem;
      flex-wrap: wrap;
      justify-content: center;
    }
    .jump-sm {
      background: #0f172a;
      border: 1px solid #1e293b;
      color: #fff;
      padding: .35rem .9rem;
      border-radius: .5rem;
      font-size: .7rem;
      cursor: pointer;
    }
    .jump-sm.active { background: #fff; color: #000; }
    .summary { font-size: .75rem; color: var(--muted); }

    @media (max-width: 700px) {
      .quiz-top { flex-direction: column; gap: 1rem; }
      .q-text { font-size: 1.15rem; }
      .nav-btns { gap: 1.5rem; }
      .nav-btn { width: 140px; text-align: center; }
      .fixed-names { text-align: left; }
    }
  </style>
</head>
<body>
  <div class="shell">
    <div class="progress-line"><span id="progressBar"></span></div>
    <div class="breadcrumb" id="breadcrumb">
      <span data-level="home" class="active">Home</span> /
      <span data-level="track">Program</span> /
      <span data-level="quiz">Quiz</span>
    </div>

    <!-- HOME -->
    <div id="home-screen">
      <div class="logo-name">Alqhtani.</div>
      <div class="logo-sub">ÿØÿπŸàÿßÿ™ŸÉŸÖ ‚ù§Ô∏è</div>
      <div class="select-title">Select what you want</div>
      <button class="option-btn" data-track="associate">Associate diploma</button>
      <button class="option-btn" data-track="diploma">Diploma</button>
    </div>

    <!-- SUBJECTS -->
    <div id="subject-screen">
      <div class="select-title" id="subjectTitleText">Select course</div>
      <div id="subjectList"></div>
    </div>

    <!-- QUIZ -->
    <div id="quiz-screen">
      <div class="quiz-top">
        <div>
          <div class="brand">Alqhtani.</div>
          <div class="brand-sub">ÿØÿπŸàÿßÿ™ŸÉŸÖ ‚ù§Ô∏è</div>
        </div>
        <div class="center-title">
          <div class="quiz-title" id="quizTitle">Quiz</div>
          <div class="info-chips" id="infoChips"></div>
          <!-- ÿßŸÑÿ≥ÿ∑ÿ±ŸäŸÜ ŸáŸÜÿß -->
          <div class="fixed-names">
            ÿßÿ®Ÿà ŸÖÿ≥ŸÅÿ±<br/>
            ÿßÿ®Ÿàÿ≤Ÿáÿ±Ÿá
          </div>
        </div>
        <div class="tools">
          <div class="icon-btn" id="bookmarkBtn">üîñ</div>
          <div class="icon-btn" id="restartBtn">‚Ü©</div>
          <div class="icon-btn" id="reviewBtn">üìÅ</div>
          <div class="icon-btn" id="filterBtn">üìÑ</div>
        </div>
      </div>

      <div class="q-wrap">
        <div class="badge-pill" id="qPill">Question 1 of 1</div>
        <div class="q-text">
          <span id="questionText"></span>
          <span id="resultBox" class="result"></span>
        </div>
        <div class="choices" id="choices"></div>
      </div>

      <div class="nav-area">
        <div class="nav-btns">
          <button class="nav-btn" id="prevBtn">Previous</button>
          <button class="nav-btn" id="nextBtn">Next</button>
        </div>
        <div class="jump-menu" id="jumpMenu"></div>
        <div class="summary" id="summaryBox"></div>
      </div>
    </div>
  </div>

  <script>
    const DATA = {
      associate: {
        label: "Associate diploma",
        subjects: [
          { name: "Gen I&K Part 1 ÿ™ÿ≥ÿ±Ÿäÿ®ÿßÿ™", file: "Gen I&K Part 1 ÿ™ÿ≥ÿ±Ÿäÿ®ÿßÿ™.txt" },
          { name: "Gen I&K Part 2 brightspace 1", file: "Gen I&K Part 2 brightspace 1.txt" },
          { name: "Gen I&K Part 3 out", file: "Gen I&K Part 3 out.txt" },
          { name: "Gen I&K Part 4 Book", file: "Gen I&K Part 4 Book.txt" },
          { name: "Gen J Part 1", file: "Gen J Part 1.txt" },
          { name: "AFI C Part 1", file: "AFI C Part 1.txt" },
        ]
      },
      diploma: {
        label: "Diploma",
        subjects: []
      }
    };

    let currentTrack = null;
    let currentSubject = null;
    let questions = [];
    let currentIndex = 0;
    let answers = {};
    let bookmarks = [];
    let viewMode = "all";

    const homeScreen = document.getElementById("home-screen");
    const subjectScreen = document.getElementById("subject-screen");
    const quizScreen = document.getElementById("quiz-screen");
    const subjectList = document.getElementById("subjectList");
    const subjectTitleText = document.getElementById("subjectTitleText");
    const breadcrumb = document.getElementById("breadcrumb");
    const quizTitle = document.getElementById("quizTitle");
    const infoChips = document.getElementById("infoChips");
    const qPill = document.getElementById("qPill");
    const questionText = document.getElementById("questionText");
    const choicesEl = document.getElementById("choices");
    const resultBox = document.getElementById("resultBox");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const jumpMenu = document.getElementById("jumpMenu");
    const summaryBox = document.getElementById("summaryBox");
    const bookmarkBtn = document.getElementById("bookmarkBtn");
    const restartBtn = document.getElementById("restartBtn");
    const reviewBtn = document.getElementById("reviewBtn");
    const filterBtn = document.getElementById("filterBtn");
    const progressBar = document.getElementById("progressBar");

    function showHome() {
      homeScreen.style.display = "block";
      subjectScreen.style.display = "none";
      quizScreen.style.display = "none";
      setBreadcrumb("home");
      questions = [];
      answers = {};
      bookmarks = [];
      currentIndex = 0;
    }
    function showSubjects() {
      homeScreen.style.display = "none";
      subjectScreen.style.display = "block";
      quizScreen.style.display = "none";
      setBreadcrumb("track");
      subjectTitleText.textContent = `Select course (${DATA[currentTrack].label})`;
      subjectList.innerHTML = "";
      DATA[currentTrack].subjects.forEach(sub => {
        const btn = document.createElement("button");
        btn.className = "subject-btn";
        btn.textContent = sub.name;
        btn.addEventListener("click", () => {
          currentSubject = sub;
          loadSubjectFromText(sub);
        });
        subjectList.appendChild(btn);
      });
    }
    function showQuiz() {
      homeScreen.style.display = "none";
      subjectScreen.style.display = "none";
      quizScreen.style.display = "block";
      setBreadcrumb("quiz");
      render();
    }
    function setBreadcrumb(level) {
      const spans = breadcrumb.querySelectorAll("span[data-level]");
      spans.forEach(s => s.classList.remove("active"));
      breadcrumb.querySelector(`[data-level="${level}"]`).classList.add("active");
      if (currentTrack) {
        breadcrumb.querySelector('[data-level="track"]').textContent = DATA[currentTrack].label;
      }
    }

    async function loadSubjectFromText(sub) {
      try {
        const res = await fetch(encodeURI(sub.file));
        const txt = await res.text();
        questions = parseTxtToQuestions(txt);
        currentIndex = 0;
        answers = {};
        bookmarks = [];
        viewMode = "all";
        quizTitle.textContent = sub.name;
        showQuiz();
      } catch (e) {
        alert("Cannot load file: " + sub.file);
      }
    }

    function parseTxtToQuestions(txt) {
      const blocks = txt.split("=").map(b => b.trim()).filter(Boolean);
      const out = [];
      for (const block of blocks) {
        const lines = block.split("\n").map(l => l.trim()).filter(Boolean);
        if (!lines.length) continue;
        const question = lines[0];
        const choices = [];
        for (let i = 1; i < lines.length; i++) {
          let t = lines[i];
          let correct = false;
          if (t.includes("‚úÖ")) {
            correct = true;
            t = t.replace("‚úÖ", "").trim();
          }
          choices.push({ text: t, correct });
        }
        if (choices.length) {
          out.push({
            title: currentSubject ? currentSubject.name : "Quiz",
            text: question,
            choices
          });
        }
      }
      return out;
    }

    function getVisibleOrder() {
      const order = [...questions.keys()];
      if (viewMode === "all") return order;
      if (viewMode === "bookmarked") {
        return order.filter(i => bookmarks.includes(i));
      }
      if (viewMode === "wrong") {
        return order.filter(i => {
          const a = answers[i];
          if (!a) return false;
          return Object.values(a).includes("wrong");
        });
      }
      return order;
    }

    function calcSummary() {
      let correct = 0, wrong = 0;
      for (let i = 0; i < questions.length; i++) {
        const a = answers[i];
        if (!a) continue;
        const vals = Object.values(a);
        if (vals.includes("correct")) correct++;
        else if (vals.includes("wrong")) wrong++;
      }
      const unanswered = questions.length - correct - wrong;
      return { correct, wrong, unanswered };
    }

    function render() {
      const visible = getVisibleOrder();
      if (!visible.length) {
        questionText.textContent = "No questions.";
        choicesEl.innerHTML = "";
        return;
      }
      if (currentIndex >= visible.length) currentIndex = 0;
      const realIndex = visible[currentIndex];
      const q = questions[realIndex];

      quizTitle.textContent = currentSubject ? currentSubject.name : "Quiz";
      questionText.textContent = q.text;
      qPill.textContent = `Question ${currentIndex + 1} of ${visible.length}`;

      const { correct, wrong, unanswered } = calcSummary();
      infoChips.innerHTML = `
        <div class="chip">Total: ${questions.length}</div>
        <div class="chip">Bookmarked: ${bookmarks.length}</div>
        <div class="chip">Correct: ${correct}</div>
      `;
      const answeredCount = questions.length - unanswered;
      progressBar.style.width = Math.round((answeredCount / questions.length) * 100) + "%";

      choicesEl.innerHTML = "";
      resultBox.textContent = "";
      resultBox.className = "result";

      const saved = answers[realIndex] || {};
      q.choices.forEach((c, idx) => {
        const btn = document.createElement("button");
        btn.className = "choice-btn";
        btn.innerHTML = `<strong>${idx + 1}</strong> ${c.text}`;
        if (saved[idx] === "correct") btn.classList.add("correct");
        if (saved[idx] === "wrong") btn.classList.add("wrong");
        btn.addEventListener("click", () => {
          if (!answers[realIndex]) answers[realIndex] = {};
          if (c.correct) {
            answers[realIndex][idx] = "correct";
            resultBox.textContent = "Correct ‚úî";
            resultBox.classList.add("correct");
          } else {
            answers[realIndex][idx] = "wrong";
            resultBox.textContent = "Wrong ‚úò";
            resultBox.classList.add("wrong");
          }
          render();
        });
        choicesEl.appendChild(btn);
      });

      prevBtn.disabled = currentIndex === 0;
      nextBtn.disabled = currentIndex === visible.length - 1;

      buildPagination(visible.length, currentIndex);

      if (unanswered === 0) {
        summaryBox.textContent = `Done: ${correct} correct, ${wrong} wrong`;
      } else {
        summaryBox.textContent = `Progress: ${correct} correct, ${wrong} wrong, ${unanswered} unanswered`;
      }

      bookmarkBtn.classList.toggle("active", bookmarks.includes(realIndex));
      filterBtn.classList.toggle("active", viewMode === "bookmarked");
      reviewBtn.classList.toggle("active", viewMode === "wrong");
    }

    function buildPagination(total, current) {
      jumpMenu.innerHTML = "";
      const pageLabel = document.createElement("div");
      pageLabel.className = "jump-sm";
      pageLabel.textContent = `PAGE ${current + 1} OF ${total}`;
      jumpMenu.appendChild(pageLabel);

      for (let i = 0; i < Math.min(4, total); i++) {
        const b = document.createElement("button");
        b.className = "jump-sm" + (i === current ? " active" : "");
        b.textContent = i + 1;
        b.addEventListener("click", () => { currentIndex = i; render(); });
        jumpMenu.appendChild(b);
      }

      if (total > 10) {
        const dots1 = document.createElement("button");
        dots1.className = "jump-sm";
        dots1.textContent = "...";
        dots1.disabled = true;
        jumpMenu.appendChild(dots1);

        const ten = document.createElement("button");
        ten.className = "jump-sm" + (9 === current ? " active" : "");
        ten.textContent = "10";
        ten.addEventListener("click", () => { currentIndex = 9; render(); });
        jumpMenu.appendChild(ten);

        const twenty = document.createElement("button");
        twenty.className = "jump-sm" + (19 === current ? " active" : "");
        twenty.textContent = "20";
        twenty.addEventListener("click", () => { currentIndex = 19; render(); });
        if (total >= 20) jumpMenu.appendChild(twenty);

        const dots2 = document.createElement("button");
        dots2.className = "jump-sm";
        dots2.textContent = "...";
        dots2.disabled = true;
        jumpMenu.appendChild(dots2);
      }

      if (current < total - 1) {
        const nextPage = document.createElement("button");
        nextPage.className = "jump-sm";
        nextPage.textContent = ">";
        nextPage.addEventListener("click", () => { currentIndex = current + 1; render(); });
        jumpMenu.appendChild(nextPage);
      }

      if (total > 1) {
        const last = document.createElement("button");
        last.className = "jump-sm";
        last.textContent = "LAST PAGE";
        last.addEventListener("click", () => { currentIndex = total - 1; render(); });
        jumpMenu.appendChild(last);
      }
    }

    document.querySelectorAll(".option-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        currentTrack = btn.dataset.track;
        showSubjects();
      });
    });

    breadcrumb.addEventListener("click", e => {
      const level = e.target.dataset.level;
      if (!level) return;
      if (level === "home") showHome();
      if (level === "track" && currentTrack) showSubjects();
    });

    prevBtn.addEventListener("click", () => {
      const visible = getVisibleOrder();
      if (currentIndex > 0) {
        currentIndex--;
        render();
      }
    });
    nextBtn.addEventListener("click", () => {
      const visible = getVisibleOrder();
      if (currentIndex < visible.length - 1) {
        currentIndex++;
        render();
      }
    });

    bookmarkBtn.addEventListener("click", () => {
      const visible = getVisibleOrder();
      const realIndex = visible[currentIndex];
      const i = bookmarks.indexOf(realIndex);
      if (i === -1) bookmarks.push(realIndex);
      else bookmarks.splice(i, 1);
      render();
    });
    filterBtn.addEventListener("click", () => {
      if (viewMode === "bookmarked") viewMode = "all";
      else {
        if (!bookmarks.length) { alert("No bookmarked questions."); return; }
        viewMode = "bookmarked";
        currentIndex = 0;
      }
      render();
    });
    reviewBtn.addEventListener("click", () => {
      const haveWrong = Object.values(answers).some(a => Object.values(a).includes("wrong"));
      if (!haveWrong) { alert("No wrong answers to review."); return; }
      viewMode = viewMode === "wrong" ? "all" : "wrong";
      currentIndex = 0;
      render();
    });
    restartBtn.addEventListener("click", () => {
      answers = {};
      bookmarks = [];
      currentIndex = 0;
      viewMode = "all";
      render();
    });

    showHome();
  </script>
</body>
</html>
